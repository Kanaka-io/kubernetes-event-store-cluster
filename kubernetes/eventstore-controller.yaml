kind: ReplicationController
apiVersion: v1
metadata:
  name: eventstore-cluster
  namespace: eventstore
spec:
  replicas: 3
  selector:
    name: eventstore-node
  template:
    metadata:
      namespace: eventstore
      labels:
        name: eventstore-node
        app: eventstore-cluster
    spec:
      containers:
      - name: eventstore-node
        image: dcr.mfb.io/eventstore
        ports:
        - containerPort: 2113
        - containerPort: 2112
        - containerPort: 1113
        - containerPort: 1112
        env:
        - name: EVENTSTORE_CLUSTER_SIZE
          value: "3"
        - name: EVENTSTORE_CLUSTER_GOSSIP_PORT
          value: "2112"
        - name: EVENTSTORE_CLUSTER_DNS
          value: "eventstore-service.eventstore"
        - name: EVENTSTORE_INT_IP
          value: "0.0.0.0"
        - name: EVENTSTORE_EXT_IP
          value: "0.0.0.0"
        - name: EVENTSTORE_EXT_HTTP_PREFIXES
          value: "http://*:2113/"
        - name: EVENTSTORE_INT_HTTP_PREFIXES
          value: "http://*:2112/"
        volumeMounts:
        - mountPath: /var/lib/eventstore
          name: data
      volumes:
        - name: data
          emptyDir: {}
